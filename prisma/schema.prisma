generator client {
  provider = "prisma-client-js"
}

datasource mysql {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model users {
  checkLocationOnLogin Boolean              @default(false)
  countryCode          String               @default("us")
  createdAt            DateTime             @default(now())
  gender               String               @default("x")
  id                   Int                  @id @default(autoincrement())
  name                 String
  nickname             String
  notificationEmails   Int                  @default(1)
  password             String?
  prefersLanguage      String               @default("en-us")
  prefersColorScheme   String               @default("system")
  prefersReducedMotion String               @default("no-preference")
  primaryEmail         Int?
  profilePicture       String
  role                 Int                  @default(1)
  timezone             String               @default("Europe/Amsterdam")
  twoFactorEnabled     Boolean              @default(false)
  twoFactorSecret      String?
  updatedAt            DateTime             @updatedAt
  username             String               @unique
  emails               emails[]             @relation(name: "emails")
  access_tokens        access_tokens[]      @relation(name: "access_tokens")
  approved_locations   approved_locations[] @relation(name: "approved_locations")
  backup_codes         backup_codes[]       @relation(name: "backup_codes")
  identities           identities[]         @relation(name: "identities")
  memberships          memberships[]        @relation(name: "memberships")
  sessions             sessions[]           @relation(name: "sessions")
}

model organizations {
  autoJoinDomain   Boolean  @default(false)
  createdAt        DateTime @default(now())
  forceTwoFactor   Boolean  @default(false)
  id               Int      @id @default(autoincrement())
  ipRestrictions   String?
  name             String?
  onlyAllowDomain  Boolean  @default(false)
  profilePicture   String   @default("https://unavatar.now.sh/fallback.png")
  stripeCustomerId String?
  updatedAt        DateTime @updatedAt
  username         String   @unique
}

model emails {
  createdAt  DateTime @default(now())
  email      String
  id         Int      @id @default(autoincrement())
  isVerified Boolean  @default(false)
  updatedAt  DateTime @updatedAt
  user       users    @relation(fields: [userId], references: [id])
  userId     Int

  @@index([userId], name: "userId")
}

model access_tokens {
  createdAt      DateTime @default(now())
  description    String?
  expiresAt      DateTime
  id             Int      @id @default(autoincrement())
  jwtAccessToken String
  name           String?
  scopes         String?
  updatedAt      DateTime @updatedAt
  user           users    @relation(fields: [userId], references: [id])
  userId         Int

  @@index([userId], name: "userId")
  @@map("access-tokens")
}

model api_keys {
  createdAt            DateTime @default(now())
  description          String?
  expiresAt            DateTime
  id                   Int      @id @default(autoincrement())
  ipRestrictions       String?
  jwtApiKey            String
  name                 String?
  organizationId       Int
  referrerRestrictions String?
  scopes               String?
  updatedAt            DateTime @updatedAt

  @@map("api-keys")
}

model approved_locations {
  createdAt DateTime? @default(now())
  id        Int       @id @default(autoincrement())
  subnet    String
  user      users    @relation(fields: [userId], references: [id])
  userId    Int

  @@map("approved-locations")
}

model backup_codes {
  id        Int      @id @default(autoincrement())
  code      String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  used      Boolean  @default(false)
  user      users    @relation(fields: [userId], references: [id])
  userId    Int

  @@index([userId], name: "idId")
  @@map("backup-codes")
}

model domains {
  createdAt        DateTime @default(now())
  domain           String
  id               Int      @id @default(autoincrement())
  isVerified       Boolean  @default(false)
  organizationId   Int
  updatedAt        DateTime @updatedAt
  verificationCode String

  @@index([organizationId], name: "organizationId")
}

model identities {
  createdAt  DateTime @default(now())
  id         Int      @id @default(autoincrement())
  identityId String
  loginName  String
  type       String
  updatedAt  DateTime @updatedAt
  user       users    @relation(fields: [userId], references: [id])
  userId     Int

  @@index([userId], name: "userId")
}

model memberships {
  createdAt      DateTime @default(now())
  id             Int      @id @default(autoincrement())
  organizationId Int
  role           String   @default("member")
  updatedAt      DateTime @updatedAt
  user           users    @relation(fields: [userId], references: [id])
  userId         Int

  @@index([organizationId], name: "organizationId")
  @@index([userId], name: "userId")
}

model sessions {
  createdAt DateTime @default(now())
  id        Int      @id @default(autoincrement())
  ipAddress String
  jwtToken  String
  updatedAt DateTime @updatedAt
  userAgent String
  user      users    @relation(fields: [userId], references: [id])
  userId    Int

  @@index([userId], name: "userId")
}

model webhooks {
  contentType    String
  createdAt      DateTime  @default(now())
  event          String
  id             Int       @id @default(autoincrement())
  isActive       Boolean   @default(false)
  lastFiredAt    DateTime?
  organizationId Int
  secret         String?
  updatedAt      DateTime  @updatedAt
  url            String

  @@index([organizationId], name: "organizationId")
}
